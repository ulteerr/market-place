components:
  schemas:

    User:
      type: object
      required: [id, email, first_name, last_name]
      properties:
        id:
          type: string
          format: uuid
          example: d3302fd5-360b-48ba-a049-40aa4accf26f
        email:
          type: string
          format: email
          example: alex.johnson@example.com
        first_name:
          type: string
          example: Alex
        last_name:
          type: string
          example: Johnson
        middle_name:
          type: string
          nullable: true
          example: Michael
        phone:
          type: string
          nullable: true
          example: "+79998887766"
        roles:
          type: array
          description: Global platform roles
          items:
            type: string
          example: [participant, admin]
        permission_overrides:
          $ref: '#/components/schemas/UserPermissionOverrides'

        is_admin:
          type: boolean
          example: true

        can_access_admin_panel:
          type: boolean
          example: true
        settings:
          $ref: '#/components/schemas/UserSettings'
        avatar:
          allOf:
            - $ref: '#/components/schemas/UserFile'
          nullable: true


    UserResponse:
      type: object
      required: [status, user]
      properties:
        status:
          type: string
          example: ok
        user:
          $ref: '#/components/schemas/User'


    UpdateMeRequest:
      type: object
      properties:
        first_name:
          type: string
        last_name:
          type: string
        email:
          type: string
          format: email


    UpdateMePasswordRequest:
      type: object
      required: [password, password_confirmation]
      properties:
        password:
          type: string
          format: password
        password_confirmation:
          type: string
          format: password

    UpdateMeSettingsRequest:
      type: object
      required: [settings]
      properties:
        settings:
          $ref: '#/components/schemas/UserSettings'

    UserSettings:
      type: object
      properties:
        locale:
          type: string
          nullable: true
          enum: [ru, en]
          example: en
        theme:
          type: string
          enum: [light, dark]
          example: dark
        collapse_menu:
          type: boolean
          example: false
        admin_crud_preferences:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/AdminCrudPreference'
        admin_navigation_sections:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/AdminNavigationSectionPreference'
      additionalProperties: true
      example:
        locale: en
        theme: dark
        collapse_menu: false
        admin_crud_preferences:
          users:
            contentMode: cards
            tableOnDesktop: false
        admin_navigation_sections:
          system:
            open: true

    AdminCrudPreference:
      type: object
      properties:
        contentMode:
          type: string
          enum: [table, table-cards, cards]
          example: table-cards
        tableOnDesktop:
          type: boolean
          example: true
      additionalProperties: false

    AdminNavigationSectionPreference:
      type: object
      properties:
        open:
          type: boolean
          example: true
      additionalProperties: false


    CreateAdminUserRequest:
      type: object
      required:
        - first_name
        - last_name
        - email
        - password
        - password_confirmation
      properties:
        first_name:
          type: string
          maxLength: 255
          example: John
        last_name:
          type: string
          maxLength: 255
          example: Doe
        middle_name:
          type: string
          nullable: true
          maxLength: 255
          example: M
        email:
          type: string
          format: email
          example: john@example.com
        password:
          type: string
          format: password
          minLength: 6
          example: password123
        password_confirmation:
          type: string
          format: password
          minLength: 6
          example: password123
        phone:
          type: string
          nullable: true
          maxLength: 20
          example: "+79998887766"
        roles:
          type: array
          items:
            type: string
          example: [moderator]
        permission_overrides:
          $ref: '#/components/schemas/UserPermissionOverrides'


    UpdateAdminUserRequest:
      type: object
      properties:
        first_name:
          type: string
          maxLength: 255
          example: John
        last_name:
          type: string
          maxLength: 255
          example: Doe
        middle_name:
          type: string
          nullable: true
          maxLength: 255
          example: M
        email:
          type: string
          format: email
          example: john@example.com
        password:
          type: string
          format: password
          minLength: 6
          example: password123
        password_confirmation:
          type: string
          format: password
          minLength: 6
          example: password123
        phone:
          type: string
          nullable: true
          maxLength: 20
          example: "+79998887766"
        roles:
          type: array
          items:
            type: string
          example: [admin, moderator]
        permission_overrides:
          $ref: '#/components/schemas/UserPermissionOverrides'

    UserPermissionOverrides:
      type: object
      properties:
        allow:
          type: array
          items:
            type: string
          example: [admin.users.read]
        deny:
          type: array
          items:
            type: string
          example: [admin.roles.delete]

    AdminUserRoleListItem:
      type: object
      required: [id, code]
      properties:
        id:
          type: string
          format: uuid
          example: d3302fd5-360b-48ba-a049-40aa4accf26f
        code:
          type: string
          example: moderator

    AdminUserListItem:
      type: object
      required: [id, email, first_name, last_name]
      properties:
        id:
          type: string
          format: uuid
          example: d3302fd5-360b-48ba-a049-40aa4accf26f
        email:
          type: string
          format: email
          example: alex.johnson@example.com
        first_name:
          type: string
          example: Alex
        last_name:
          type: string
          example: Johnson
        middle_name:
          type: string
          nullable: true
          example: Michael
        phone:
          type: string
          nullable: true
          example: "+79998887766"
        roles:
          type: array
          items:
            $ref: '#/components/schemas/AdminUserRoleListItem'
        can_access_admin_panel:
          type: boolean
          nullable: true
          example: true
        avatar:
          allOf:
            - $ref: '#/components/schemas/UserFile'
          nullable: true

    AdminUsersPaginatedResponse:
      type: object
      required: [status, data]
      properties:
        status:
          type: string
          example: ok
        data:
          type: object
          required: [current_page, data, last_page, per_page, total]
          properties:
            current_page:
              type: integer
              example: 1
            last_page:
              type: integer
              example: 3
            per_page:
              type: integer
              example: 20
            total:
              type: integer
              example: 56
            data:
              type: array
              items:
                $ref: '#/components/schemas/AdminUserListItem'

    UserFile:
      type: object
      required: [id, url, original_name, collection]
      properties:
        id:
          type: string
          format: uuid
          example: d3302fd5-360b-48ba-a049-40aa4accf26f
        url:
          type: string
          format: uri
          example: http://localhost:8080/storage/uploads/2026/02/avatar.png
        original_name:
          type: string
          example: avatar.png
        mime_type:
          type: string
          nullable: true
          example: image/png
        size:
          type: integer
          example: 48231
        collection:
          type: string
          example: avatar
