import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Docs/Frontend/RU/Auth and Session" />

# Аутентификация и сессия

## Модель авторизации

- Backend использует bearer token (Sanctum-совместимый flow).
- Frontend хранит:
  - cookie `auth_token`
  - cookie `auth_user`
- Сессия восстанавливается при инициализации приложения через `/api/me`.

## Жизненный цикл

1. Форма логина отправляет credentials.
2. Frontend получает token и user payload.
3. Cookies обновляются.
4. При следующей загрузке приложение обновляет пользователя по token.
5. При logout frontend очищает локальное auth-состояние независимо от результата logout API.

## Контроль доступа

- Проверки на уровне роутов закрывают доступ в админку для неавторизованных пользователей.
- Capability-флаги и permissions из user payload управляют доступом к UI и действиям.

## Ожидания по персистентности сессии

- Cookies должны быть persistent (а не session-only), если сессия должна переживать перезапуск браузера.
- Любые изменения cookie-политики нужно отражать в этом документе и проверять вручную:
  - login
  - закрыть браузер
  - открыть браузер
  - проверить состояние доступа к `/admin`
