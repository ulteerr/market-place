import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Docs/Frontend/RU/Data and API" />

# Данные и интеграция с API

## Паттерн доступа к API

- `composables/useApi.ts` предоставляет настроенный fetch-клиент.
- Feature-composables вызывают endpoint'ы и маппят ответы для pages/components.
- Заголовок авторизации строится из auth-cookie состояния.

## Ответственность composables

- Обработка параметров запроса и парсинг ответа.
- Типизированные возвращаемые значения там, где это практично.
- Нормализация backend-специфичных форматов перед отдачей в UI.
- Поверхностные ошибки переводятся в понятные сообщения для пользователя.

## Принципы обработки ошибок

- Транспортные и валидационные ошибки обрабатываются по-разному.
- Logout очищает локальное auth-состояние даже при ошибке logout API.
- UI не должен зависеть от сырого формата backend-ошибок.

## Процесс эволюции API

1. Изменяется backend/OpenAPI контракт.
2. Обновляются frontend composables и UI-адаптеры.
3. Обновляются e2e и unit тесты под новое поведение.
4. При изменении интеграционного контракта обновляется документация фронтенда.
